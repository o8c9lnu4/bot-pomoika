(()=>{"use strict";var t={1831:(t,e,s)=>{s(3792),s(3362),s(9085),s(9391),s(4423),s(6099),s(1699);var a=s(5471),r=s(8505),o=s(6929),n=s(2756),i=s(1526),l=s(6278),c=s(1906),u=s(9781),d=s(9456),p=s(7954),m=s(8412),f=s(1735),h=(s(3288),function(){var t=this,e=t._self._c;return e(r.A,{attrs:{dark:""}},[e(o.A,{staticClass:"border-bottom",attrs:{app:"",flat:"",color:"#151226",elevation:"0",height:"48"}},[e(l.A,{staticClass:"py-0 px-3"},[e(m.A,{attrs:{align:"center","no-gutters":""}},[e(i.A,{attrs:{cols:"auto"}},[e(f.sw,{staticClass:"text-h6 font-weight-medium"},[e("span",{staticClass:"white--text"},[t._v("Pomoika Vape Lab")])])],1),e(i.A,{staticClass:"ml-auto",attrs:{cols:"auto"}},[e(n.A,{staticStyle:{color:"#BB86FC"},attrs:{icon:"",small:""},on:{click:t.refreshData}},[e(d.A,{attrs:{small:""}},[t._v("mdi-refresh")])],1)],1)],1)],1)],1),e(p.A,{staticStyle:{background:"#0d0b14",height:"calc(100vh - 48px)"}},[e(l.A,{staticClass:"py-2 px-3",attrs:{fluid:""}},[e(c.mM,{attrs:{mode:"out-in"}},[e("router-view")],1)],1)],1),e(u.A,{attrs:{app:"",flat:"",color:"#151226",dark:"",padless:"",height:"32"}},[e(l.A,{staticClass:"py-1 px-3"},[e(m.A,[e(i.A,{staticClass:"text-center",attrs:{cols:"12"}},[e("div",{staticClass:"text-caption",staticStyle:{color:"#9E8CFF"}},[t._v(" "+t._s((new Date).getFullYear())+" — Pomoika Vape Lab ")])])],1)],1)],1)],1)}),v=[];const g={name:"App",data:function(){return{darkMode:!1}},methods:{refreshData:function(){this.$root.$emit("refresh-data"),window.Telegram&&window.Telegram.WebApp&&window.Telegram.WebApp.showAlert("Данные обновлены")}},mounted:function(){window.Telegram&&window.Telegram.WebApp&&(window.Telegram.WebApp.setHeaderColor("#151226"),window.Telegram.WebApp.setBackgroundColor("#0d0b14"))}},A=g;var _=s(1656),b=(0,_.A)(A,h,v,!1,null,null,null);const x=b.exports;s(5086),s(8111),s(3579),s(9432);var w=s(173),k=s(1689),y=s(8834),C=s(5664),P=s(6016),S=function(){var t=this,e=t._self._c;return e("div",[e(l.A,{staticClass:"py-4"},[e(m.A,[e(i.A,{attrs:{cols:"12"}},[e("div",{staticClass:"mb-4"},[e("h1",{staticClass:"text-h5 font-weight-medium white--text mb-1"},[t._v("Новости")]),e("div",{staticClass:"text-caption",staticStyle:{color:"#BDB4FF"}},[t._v("Последние публикации")])])])],1),e(m.A,t._l(t.posts,(function(s){return e(i.A,{key:s.id,attrs:{cols:"12"}},[e(C.A,{scopedSlots:t._u([{key:"default",fn:function(a){var r=a.hover;return[e(k.A,{staticClass:"mx-auto transition-swing post-card-mini",class:{"on-hover":r},attrs:{elevation:r?4:1,color:"#151226"},on:{click:function(e){return t.goToPost(s.id)}}},[e(y.OQ,{staticClass:"pa-3"},[e("div",{staticClass:"d-flex align-start justify-space-between mb-2"},[e("h3",{staticClass:"text-subtitle-1 font-weight-medium white--text mb-1",staticStyle:{"line-height":"1.3"}},[t._v(" "+t._s(s.title)+" ")]),e(d.A,{staticStyle:{color:"#BB86FC"},attrs:{small:""}},[t._v("mdi-chevron-right")])],1),e("div",{staticClass:"text-body-2 mb-2 post-excerpt-mini",staticStyle:{color:"#D7D2FF"}},[t._v(" "+t._s(s.content)+" ")]),e("div",{staticClass:"text-caption",staticStyle:{color:"#A39AE6"}},[t._v(" "+t._s(t.formatDate(s.published_date))+" ")])])],1)]}}],null,!0)})],1)})),1),0!==t.posts.length||t.loading?t._e():e(m.A,{staticClass:"mt-6"},[e(i.A,{staticClass:"mx-auto",attrs:{cols:"12",sm:"8",md:"6"}},[e(k.A,{staticClass:"text-center pa-6",attrs:{flat:"",color:"#151226"}},[e("h2",{staticClass:"text-h5 font-weight-light mb-2 white--text"},[t._v(" Пока нет опубликованных постов ")]),e("p",{staticClass:"text-body-1",staticStyle:{color:"#A39AE6"},attrs:{"mb-0":""}},[t._v(" Загляните позже ")])])],1)],1),t.totalPages>1?e(m.A,{staticClass:"mt-8"},[e(i.A,{staticClass:"text-center",attrs:{cols:"12"}},[e(P.A,{staticClass:"custom-pagination",attrs:{length:t.totalPages,"total-visible":7,color:"#BB86FC"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1):t._e()],1)],1)},D=[],F=s(4048),O=s(388),$=(s(4114),s(6031),s(2505)),U=s.n($);const T={name:"PostList",data:function(){return{posts:[],currentPage:1,totalPages:1,loading:!1}},methods:{fetchPosts:function(){var t=this;return(0,O.A)((0,F.A)().mark((function e(){var s;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,console.log("Fetching posts from:","/api/posts/?page=".concat(t.currentPage)),e.next=5,U().get("/api/posts/?page=".concat(t.currentPage));case 5:s=e.sent,console.log("API Response:",s.data),t.posts=s.data.results,t.totalPages=Math.ceil(s.data.count/10),e.next=16;break;case 11:e.prev=11,e.t0=e["catch"](1),console.error("Error fetching posts:",e.t0),console.error("Error details:",{message:e.t0.message,response:e.t0.response?{status:e.t0.response.status,data:e.t0.response.data}:"No response",config:{url:e.t0.config.url,method:e.t0.config.method,baseURL:e.t0.config.baseURL}}),window.Telegram&&window.Telegram.WebApp&&window.Telegram.WebApp.showAlert("Ошибка загрузки данных");case 16:return e.prev=16,setTimeout((function(){t.loading=!1}),500),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,11,16,19]])})))()},formatDate:function(t){return new Date(t).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"})},goToPost:function(t){this.$router.push({name:"PostDetail",params:{id:t}})}},watch:{currentPage:function(){this.fetchPosts()}},created:function(){this.fetchPosts()},mounted:function(){var t=this;this.$root.$on("refresh-data",(function(){t.fetchPosts()}))}},L=T;var I=(0,_.A)(L,S,D,!1,null,"2338ad36",null);const E=I.exports;var R=s(1770),j=s(2585),B=function(){var t=this,e=t._self._c;return e("div",[e(l.A,{staticClass:"py-8"},[e(m.A,[e(i.A,{attrs:{cols:"12"}},[e(n.A,{staticClass:"mb-8 text-capitalize",attrs:{text:"",color:"black",to:"/",flat:""}},[t._v(" ← Назад ")])],1)],1),t.loading?e(m.A,{staticStyle:{"min-height":"400px"},attrs:{justify:"center",align:"center"}},[e(i.A,{attrs:{cols:"auto"}},[e(j.A,{attrs:{indeterminate:"",color:"black",size:"32"}})],1)],1):t.post?[e(m.A,[e(i.A,{staticClass:"mx-auto",attrs:{cols:"12",lg:"8"}},[e("article",[e("header",{staticClass:"mb-8"},[e("h1",{staticClass:"text-h2 font-weight-light black--text mb-4"},[t._v(t._s(t.post.title))]),e("div",{staticClass:"d-flex align-center"},[e("span",{staticClass:"text-body-2 grey--text"},[t._v(t._s(t.formatDate(t.post.published_date)))]),e(R.A,{staticClass:"mx-4",attrs:{vertical:""}}),e("span",{staticClass:"text-body-2 grey--text"},[t._v(t._s(t.getReadingTime())+" мин. чтения")])],1)]),e("div",{staticClass:"post-content"},[e("div",{staticClass:"text-body-1 grey--text text--darken-2"},[t._v(t._s(t.post.content))])]),e("footer",{staticClass:"mt-8 pt-4 border-top"},[e(n.A,{staticClass:"text-capitalize",attrs:{text:"",color:"black"},on:{click:t.sharePost}},[t._v(" Поделиться ")])],1)])])],1)]:e(m.A,{attrs:{justify:"center"}},[e(i.A,{staticClass:"mx-auto",attrs:{cols:"12",sm:"8",md:"6"}},[e(k.A,{staticClass:"text-center pa-6",attrs:{flat:""}},[e("h2",{staticClass:"text-h5 font-weight-light mb-2 black--text"},[t._v(" Пост не найден ")]),e("p",{staticClass:"text-body-1 grey--text mb-4"},[t._v(" Возможно, он был удален или перемещен. ")]),e(n.A,{staticClass:"text-capitalize",attrs:{color:"black",to:"/",outlined:""}},[t._v(" Вернуться на главную ")])],1)],1)],1)],2)],1)},Q=[];s(8130),s(7495),s(744),s(2762);const V={name:"PostDetail",props:{id:{type:[String,Number],required:!0}},data:function(){return{post:null,loading:!1}},methods:{fetchPost:function(){var t=this;return(0,O.A)((0,F.A)().mark((function e(){var s;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,U().get("/api/posts/".concat(t.id,"/"));case 4:s=e.sent,t.post=s.data,e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error("Error fetching post:",e.t0),t.post=null;case 12:return e.prev=12,setTimeout((function(){t.loading=!1}),500),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})))()},formatDate:function(t){return new Date(t).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},getReadingTime:function(){var t;if(null===(t=this.post)||void 0===t||!t.content)return 1;var e=this.post.content.trim().split(/\s+/).length;return Math.max(1,Math.ceil(e/200))},sharePost:function(){navigator.share&&navigator.share({title:this.post.title,text:this.post.content.substring(0,100)+"...",url:window.location.href})}},created:function(){this.fetchPost()}},M=V;var N=(0,_.A)(M,B,Q,!1,null,"5b7642db",null);const q=N.exports;var W=s(8230),z=s(7410),H=s(3406),J=s(7043),Y=function(){var t=this,e=t._self._c;return e(l.A,{staticClass:"fill-height",attrs:{fluid:""}},[e(m.A,{attrs:{align:"center",justify:"center"}},[e(i.A,{attrs:{cols:"12",sm:"8",md:"4"}},[e(k.A,{staticClass:"elevation-12"},[e(J.A,{attrs:{dark:"",color:"primary"}},[e(f.sw,[t._v("Вход в админку")])],1),e(y.OQ,[e(W.A,{on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[e(H.A,{attrs:{label:"Имя пользователя",name:"username","prepend-icon":"mdi-account",type:"text",required:"","error-messages":t.errors.username},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}}),e(H.A,{attrs:{label:"Пароль",name:"password","prepend-icon":"mdi-lock",type:"password",required:"","error-messages":t.errors.password},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)],1),e(y.SL,[e(z.A),e(n.A,{attrs:{color:"primary",loading:t.loading},on:{click:t.login}},[t._v(" Войти ")])],1)],1)],1)],1)],1)},Z=[],X=s(4119);s(6918),s(9089),s(739),s(3110),s(8781);const G={name:"AdminLogin",data:function(){return{form:{username:"",password:""},errors:{},loading:!1}},methods:{login:function(){var t=this;return(0,O.A)((0,F.A)().mark((function e(){var s,a;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,t.errors={},e.prev=2,e.next=5,U().post("/api/auth/login/",t.form);case 5:if(s=e.sent,!s.data.message){e.next=16;break}if(a=s.data.user,a.is_staff){e.next=11;break}return t.$toast.error("У вас нет прав доступа к админке"),e.abrupt("return");case 11:localStorage.setItem("admin_user",JSON.stringify(a)),localStorage.setItem("is_admin","true"),localStorage.setItem("admin_token",Date.now().toString()),t.$toast.success("Добро пожаловать в админку!"),t.$router.push("/admin");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](2),e.t0.response&&e.t0.response.data?"object"===(0,X.A)(e.t0.response.data)?t.errors=e.t0.response.data:t.$toast.error(e.t0.response.data):t.$toast.error("Ошибка при входе в систему");case 21:return e.prev=21,t.loading=!1,e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[2,18,21,24]])})))()}},mounted:function(){"true"===localStorage.getItem("is_admin")&&this.$router.push("/admin")}},K=G;var tt=(0,_.A)(K,Y,Z,!1,null,"dbb5d08c",null);const et=tt.exports;var st=s(8400),at=s(2987),rt=s(1075),ot=s(6315),nt=s(4086),it=s(24),lt=s(6520),ct=s(8031),ut=(s(4298),function(){var t=this,e=t._self._c;return e(r.A,[e(ct.A,{attrs:{"mini-variant":t.miniVariant,clipped:t.clipped,fixed:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[e(at.A,t._l(t.items,(function(s,a){return e(rt.A,{key:a,attrs:{to:s.to,router:"",exact:""}},[e(ot.A,[e(d.A,[t._v(t._s(s.icon))])],1),e(nt.pr,[e(nt.UZ,{domProps:{textContent:t._s(s.title)}})],1)],1)})),1)],1),e(o.A,{attrs:{"clipped-left":t.clipped,fixed:"",app:""}},[e(st.A,{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),e(n.A,{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.miniVariant=!t.miniVariant}}},[e(d.A,[t._v("mdi-"+t._s("chevron-".concat(t.miniVariant?"right":"left")))])],1),e(n.A,{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.clipped=!t.clipped}}},[e(d.A,[t._v("mdi-application")])],1),e(f.sw,{domProps:{textContent:t._s(t.title)}}),e(z.A),e(lt.A,{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(s){var a=s.on,r=s.attrs;return[e(n.A,t._g(t._b({attrs:{icon:""}},"v-btn",r,!1),a),[e(d.A,[t._v("mdi-account-circle")])],1)]}}])},[e(at.A,[e(rt.A,[e(nt.pr,[e(nt.UZ,[t._v(t._s(t.currentUser.username))]),e(nt.w,[t._v(t._s(t.currentUser.email))])],1)],1),e(R.A),e(rt.A,{on:{click:t.logout}},[e(it.A,[e(d.A,[t._v("mdi-logout")])],1),e(nt.pr,[e(nt.UZ,[t._v("Выйти")])],1)],1)],1)],1)],1),e(p.A,[e(l.A,{attrs:{fluid:""}},[e("router-view")],1)],1),e(u.A,{attrs:{absolute:!t.fixed,app:""}},[e("span",[t._v("© "+t._s((new Date).getFullYear())+" Pomoika Vape Lab Admin")])])],1)}),dt=[];const pt={name:"AdminLayout",data:function(){return{clipped:!1,drawer:!1,fixed:!1,currentUser:{username:"",email:""},items:[{icon:"mdi-view-dashboard",title:"Панель управления",to:"/admin"},{icon:"mdi-post",title:"Посты",to:"/admin/posts"},{icon:"mdi-account-group",title:"Пользователи",to:"/admin/users"}],miniVariant:!1,right:!0,rightDrawer:!1,title:"Админка"}},methods:{logout:function(){localStorage.removeItem("admin_user"),localStorage.removeItem("is_admin"),localStorage.removeItem("admin_token"),this.$router.push("/admin/login")},loadUserData:function(){var t=localStorage.getItem("admin_user");if(t)try{this.currentUser=JSON.parse(t)}catch(e){console.error("Ошибка загрузки данных пользователя:",e),this.logout()}}},mounted:function(){"true"!==localStorage.getItem("is_admin")?this.$router.push("/admin/login"):this.loadUserData()}},mt=pt;var ft=(0,_.A)(mt,ut,dt,!1,null,null,null);const ht=ft.exports;var vt=s(3034),gt=function(){var t=this,e=t._self._c;return e("div",[e(m.A,[e(i.A,{attrs:{cols:"12"}},[e("h1",{staticClass:"text-h4 mb-6"},[t._v("Панель управления")])])],1),e(m.A,[e(i.A,{attrs:{cols:"12",md:"3"}},[e(k.A,{staticClass:"pa-4",attrs:{color:"primary",dark:""}},[e(y.ri,{staticClass:"text-h6"},[e(d.A,{attrs:{left:""}},[t._v("mdi-post")]),t._v(" Всего постов ")],1),e(y.OQ,[e("div",{staticClass:"text-h3"},[t._v(t._s(t.stats.totalPosts))]),e("div",{staticClass:"text-caption"},[t._v(" Опубликовано: "+t._s(t.stats.publishedPosts)+" ")])])],1)],1),e(i.A,{attrs:{cols:"12",md:"3"}},[e(k.A,{staticClass:"pa-4",attrs:{color:"success",dark:""}},[e(y.ri,{staticClass:"text-h6"},[e(d.A,{attrs:{left:""}},[t._v("mdi-account-group")]),t._v(" Пользователи ")],1),e(y.OQ,[e("div",{staticClass:"text-h3"},[t._v(t._s(t.stats.totalUsers))]),e("div",{staticClass:"text-caption"},[t._v(" Админов: "+t._s(t.stats.adminUsers)+" ")])])],1)],1),e(i.A,{attrs:{cols:"12",md:"3"}},[e(k.A,{staticClass:"pa-4",attrs:{color:"warning",dark:""}},[e(y.ri,{staticClass:"text-h6"},[e(d.A,{attrs:{left:""}},[t._v("mdi-calendar-today")]),t._v(" За сегодня ")],1),e(y.OQ,[e("div",{staticClass:"text-h3"},[t._v(t._s(t.stats.todayPosts))]),e("div",{staticClass:"text-caption"},[t._v(" Новых постов ")])])],1)],1),e(i.A,{attrs:{cols:"12",md:"3"}},[e(k.A,{staticClass:"pa-4",attrs:{color:"info",dark:""}},[e(y.ri,{staticClass:"text-h6"},[e(d.A,{attrs:{left:""}},[t._v("mdi-calendar-week")]),t._v(" За неделю ")],1),e(y.OQ,[e("div",{staticClass:"text-h3"},[t._v(t._s(t.stats.weekPosts))]),e("div",{staticClass:"text-caption"},[t._v(" Новых постов ")])])],1)],1)],1),e(m.A,{staticClass:"mt-6"},[e(i.A,{attrs:{cols:"12",md:"8"}},[e(k.A,[e(y.ri,[t._v(" Последние посты "),e(z.A),e(n.A,{attrs:{color:"primary",small:"",to:"/admin/posts"}},[t._v(" Все посты ")])],1),e(y.OQ,[e(vt.A,{attrs:{headers:t.headers,items:t.recentPosts,loading:t.loading,"items-per-page":5,"hide-default-footer":""},scopedSlots:t._u([{key:"item.published_date",fn:function(e){var s=e.item;return[t._v(" "+t._s(t.formatDate(s.published_date))+" ")]}},{key:"item.actions",fn:function(s){var a=s.item;return[e(n.A,{attrs:{small:"",color:"primary",to:"/admin/posts/".concat(a.id,"/edit")}},[t._v(" Редактировать ")])]}}])})],1)],1)],1),e(i.A,{attrs:{cols:"12",md:"4"}},[e(k.A,[e(y.ri,[t._v(" Статистика постов ")]),e(y.OQ,[e("div",{staticClass:"text-center"},[e("div",{staticClass:"text-h4 mb-2"},[t._v(t._s(t.stats.publishedPosts))]),e("div",{staticClass:"text-caption text--secondary mb-4"},[t._v("Опубликованных постов")]),e("div",{staticClass:"text-h4 mb-2"},[t._v(t._s(t.stats.totalPosts-t.stats.publishedPosts))]),e("div",{staticClass:"text-caption text--secondary mb-4"},[t._v("Черновиков")]),e(j.A,{staticClass:"mb-2",attrs:{value:t.stats.publishedPosts/t.stats.totalPosts*100,size:"80",width:"8",color:"primary"}},[t._v(" "+t._s(Math.round(t.stats.publishedPosts/t.stats.totalPosts*100))+"% ")]),e("div",{staticClass:"text-caption text--secondary"},[t._v("Процент опубликованных")])],1)])],1)],1)],1)],1)},At=[],_t=s(8676);s(2008),s(4782),s(6910),s(2489),s(7764),s(2953);const bt={name:"AdminDashboard",data:function(){return{loading:!1,stats:{totalPosts:0,publishedPosts:0,totalUsers:0,adminUsers:0,todayPosts:0,weekPosts:0},recentPosts:[],headers:[{text:"Заголовок",value:"title"},{text:"Автор",value:"author"},{text:"Дата публикации",value:"published_date"},{text:"Действия",value:"actions",sortable:!1}]}},methods:{loadStats:function(){var t=this;return(0,O.A)((0,F.A)().mark((function e(){var s,a,r,o,n,i,l,c,u;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,Promise.all([U().get("/api/posts/"),U().get("/api/users/")]);case 4:s=e.sent,a=(0,_t.A)(s,2),r=a[0],o=a[1],n=r.data,i=o.data,t.stats.totalPosts=n.length,t.stats.publishedPosts=n.filter((function(t){return t.published_date})).length,t.stats.totalUsers=i.length,t.stats.adminUsers=i.filter((function(t){return t.is_staff})).length,l=new Date,c=new Date(l.getFullYear(),l.getMonth(),l.getDate()),u=new Date(c.getTime()-6048e5),t.stats.todayPosts=n.filter((function(t){var e=new Date(t.created_date);return e>=c})).length,t.stats.weekPosts=n.filter((function(t){var e=new Date(t.created_date);return e>=u})).length,t.recentPosts=n.sort((function(t,e){return new Date(e.created_date)-new Date(t.created_date)})).slice(0,5),e.next=26;break;case 22:e.prev=22,e.t0=e["catch"](1),console.error("Ошибка загрузки статистики:",e.t0),t.$toast.error("Ошибка загрузки статистики");case 26:return e.prev=26,t.loading=!1,e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[1,22,26,29]])})))()},formatDate:function(t){return t?new Date(t).toLocaleDateString("ru-RU"):"Не опубликован"}},mounted:function(){this.loadStats()}},xt=bt;var wt=(0,_.A)(xt,gt,At,!1,null,null,null);const kt=wt.exports;var yt=s(3882),Ct=s(4155),Pt=s(5779),St=s(7402),Dt=function(){var t,e=this,s=e._self._c;return s("div",[s(m.A,[s(i.A,{attrs:{cols:"12"}},[s("div",{staticClass:"d-flex justify-space-between align-center mb-6"},[s("h1",{staticClass:"text-h4"},[e._v("Управление постами")]),s(n.A,{attrs:{color:"primary"},on:{click:e.createPost}},[s(d.A,{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" Создать пост ")],1)],1)])],1),s(k.A,[s(y.OQ,[s(vt.A,{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.posts,loading:e.loading,"items-per-page":10},scopedSlots:e._u([{key:"item.published_date",fn:function(t){var a=t.item;return[s(yt.A,{attrs:{color:a.published_date?"success":"warning",small:""}},[e._v(" "+e._s(a.published_date?"Опубликован":"Черновик")+" ")])]}},{key:"item.created_date",fn:function(t){var s=t.item;return[e._v(" "+e._s(e.formatDate(s.created_date))+" ")]}},{key:"item.actions",fn:function(t){var a=t.item;return[s(n.A,{staticClass:"mr-2",attrs:{small:"",color:"primary"},on:{click:function(t){return e.editPost(a)}}},[e._v(" Редактировать ")]),s(n.A,{staticClass:"mr-2",attrs:{small:"",color:a.published_date?"warning":"success"},on:{click:function(t){return e.togglePublish(a)}}},[e._v(" "+e._s(a.published_date?"Снять с публикации":"Опубликовать")+" ")]),s(n.A,{attrs:{small:"",color:"error"},on:{click:function(t){return e.deletePost(a)}}},[e._v(" Удалить ")])]}}])})],1)],1),s(Ct.A,{attrs:{"max-width":"800px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[s(k.A,[s(y.ri,[s("span",{staticClass:"text-h5"},[e._v(e._s(e.isEdit?"Редактировать пост":"Создать пост"))])]),s(y.OQ,[s(W.A,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s(H.A,{attrs:{label:"Заголовок",rules:e.titleRules,required:""},model:{value:e.postForm.title,callback:function(t){e.$set(e.postForm,"title",t)},expression:"postForm.title"}}),s(St.A,{attrs:{label:"Содержание",rules:e.contentRules,required:"",rows:"6"},model:{value:e.postForm.content,callback:function(t){e.$set(e.postForm,"content",t)},expression:"postForm.content"}}),s(H.A,{attrs:{label:"URL изображения"},model:{value:e.postForm.image_url,callback:function(t){e.$set(e.postForm,"image_url",t)},expression:"postForm.image_url"}}),s(Pt.A,{attrs:{label:"Опубликовать сразу"},model:{value:e.postForm.published,callback:function(t){e.$set(e.postForm,"published",t)},expression:"postForm.published"}})],1)],1),s(y.SL,[s(z.A),s(n.A,{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" Отмена ")]),s(n.A,{attrs:{color:"blue darken-1",text:"",disabled:!e.valid},on:{click:e.savePost}},[e._v(" Сохранить ")])],1)],1)],1),s(Ct.A,{attrs:{"max-width":"400px"},model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[s(k.A,[s(y.ri,{staticClass:"text-h5"},[e._v("Подтверждение удаления")]),s(y.OQ,[e._v(' Вы уверены, что хотите удалить пост "'+e._s(null===(t=e.postToDelete)||void 0===t?void 0:t.title)+'"? ')]),s(y.SL,[s(z.A),s(n.A,{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.deleteDialog=!1}}},[e._v(" Отмена ")]),s(n.A,{attrs:{color:"red darken-1",text:""},on:{click:e.confirmDelete}},[e._v(" Удалить ")])],1)],1)],1)],1)},Ft=[];s(8706),s(1629),s(1688),s(7588),s(3500),s(3296),s(7208),s(8408),s(4603),s(7566),s(8721);const Ot={name:"AdminPosts",data:function(){return{loading:!1,posts:[],dialog:!1,deleteDialog:!1,isEdit:!1,valid:!1,postToDelete:null,postForm:{title:"",content:"",image_url:"",published:!1},titleRules:[function(t){return!!t||"Заголовок обязателен"},function(t){return t&&t.length>=3||"Заголовок должен содержать минимум 3 символа"}],contentRules:[function(t){return!!t||"Содержание обязательно"},function(t){return t&&t.length>=10||"Содержание должно содержать минимум 10 символов"}],headers:[{text:"ID",value:"id",sortable:!0},{text:"Заголовок",value:"title",sortable:!0},{text:"Статус",value:"published_date",sortable:!0},{text:"Дата создания",value:"created_date",sortable:!0},{text:"Действия",value:"actions",sortable:!1}]}},methods:{loadPosts:function(){var t=this;return(0,O.A)((0,F.A)().mark((function e(){var s;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,U().get("/api/posts/");case 4:s=e.sent,t.posts=s.data,e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error("Ошибка загрузки постов:",e.t0),t.$toast.error("Ошибка загрузки постов");case 12:return e.prev=12,t.loading=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})))()},createPost:function(){this.isEdit=!1,this.postForm={title:"",content:"",image_url:"",published:!1},this.dialog=!0},editPost:function(t){this.isEdit=!0,this.postForm={id:t.id,title:t.title,content:t.content,image_url:t.image_url||"",published:!!t.published_date},this.dialog=!0},savePost:function(){var t=this;return(0,O.A)((0,F.A)().mark((function e(){var s,a,r;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$refs.form.validate()){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,a={title:t.postForm.title.trim(),content:t.postForm.content.trim(),image_url:(null===(s=t.postForm.image_url)||void 0===s?void 0:s.trim())||null,published_date:t.postForm.published?(new Date).toISOString():null},!a.image_url||t.isValidUrl(a.image_url)){e.next=7;break}return t.$toast.error("Введите корректный URL изображения"),e.abrupt("return");case 7:if(!t.isEdit){e.next=13;break}return e.next=10,U().put("/api/posts/".concat(t.postForm.id,"/"),a);case 10:t.$toast.success("Пост успешно обновлен"),e.next=16;break;case 13:return e.next=15,U().post("/api/posts/",a);case 15:t.$toast.success("Пост успешно создан");case 16:t.dialog=!1,t.loadPosts(),e.next=24;break;case 20:e.prev=20,e.t0=e["catch"](2),console.error("Ошибка сохранения поста:",e.t0),e.t0.response&&e.t0.response.data?(r=e.t0.response.data,"object"===(0,X.A)(r)?Object.keys(r).forEach((function(e){t.$toast.error("".concat(e,": ").concat(r[e]))})):t.$toast.error("Ошибка сохранения поста")):t.$toast.error("Ошибка сохранения поста");case 24:case"end":return e.stop()}}),e,null,[[2,20]])})))()},isValidUrl:function(t){try{return new URL(t),!0}catch(e){return!1}},togglePublish:function(t){var e=this;return(0,O.A)((0,F.A)().mark((function s(){var a;return(0,F.A)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,a={title:t.title,content:t.content,image_url:t.image_url,published_date:t.published_date?null:(new Date).toISOString()},s.next=4,U().put("/api/posts/".concat(t.id,"/"),a);case 4:t.published_date=a.published_date,e.$toast.success(t.published_date?"Пост опубликован":"Пост снят с публикации"),s.next=12;break;case 8:s.prev=8,s.t0=s["catch"](0),console.error("Ошибка изменения статуса публикации:",s.t0),e.$toast.error("Ошибка изменения статуса публикации");case 12:case"end":return s.stop()}}),s,null,[[0,8]])})))()},deletePost:function(t){this.postToDelete=t,this.deleteDialog=!0},confirmDelete:function(){var t=this;return(0,O.A)((0,F.A)().mark((function e(){return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U()["delete"]("/api/posts/".concat(t.postToDelete.id,"/"));case 3:t.deleteDialog=!1,t.loadPosts(),t.$toast.success("Пост удален"),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](0),console.error("Ошибка удаления поста:",e.t0),t.$toast.error("Ошибка удаления поста");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()},formatDate:function(t){return new Date(t).toLocaleDateString("ru-RU")}},mounted:function(){this.loadPosts()}},$t=Ot;var Ut=(0,_.A)($t,Dt,Ft,!1,null,null,null);const Tt=Ut.exports;var Lt=s(9555),It=(s(5746),function(){var t=this,e=t._self._c;return e("div",[e(m.A,[e(i.A,{attrs:{cols:"12"}},[e("h1",{staticClass:"text-h4 mb-6"},[t._v("Управление пользователями")])])],1),e(k.A,[e(y.OQ,[e(m.A,{staticClass:"mb-4"},[e(i.A,{attrs:{cols:"12",md:"6"}},[e(H.A,{attrs:{"append-icon":"mdi-magnify",label:"Поиск пользователей","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),e(i.A,{attrs:{cols:"12",md:"6"}},[e(Lt.A,{attrs:{items:t.statusOptions,label:"Фильтр по статусу",clearable:""},model:{value:t.statusFilter,callback:function(e){t.statusFilter=e},expression:"statusFilter"}})],1)],1),e(vt.A,{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.filteredUsers,loading:t.loading,"items-per-page":10,search:t.search},scopedSlots:t._u([{key:"item.date_joined",fn:function(e){var s=e.item;return[t._v(" "+t._s(t.formatDate(s.date_joined))+" ")]}},{key:"item.is_staff",fn:function(s){var a=s.item;return[e(yt.A,{attrs:{color:a.is_staff?"success":"default",small:""}},[t._v(" "+t._s(a.is_staff?"Администратор":"Пользователь")+" ")])]}},{key:"item.actions",fn:function(s){var a=s.item;return[e(n.A,{attrs:{small:"",color:"primary"},on:{click:function(e){return t.toggleStaffStatus(a)}}},[t._v(" "+t._s(a.is_staff?"Убрать права":"Сделать админом")+" ")])]}}])})],1)],1)],1)}),Et=[];const Rt={name:"AdminUsers",data:function(){return{loading:!1,users:[],search:"",statusFilter:null,statusOptions:[{text:"Все пользователи",value:null},{text:"Администраторы",value:!0},{text:"Обычные пользователи",value:!1}],headers:[{text:"ID",value:"id",sortable:!0},{text:"Имя пользователя",value:"username",sortable:!0},{text:"Email",value:"email",sortable:!0},{text:"Статус",value:"is_staff",sortable:!0},{text:"Дата регистрации",value:"date_joined",sortable:!0},{text:"Действия",value:"actions",sortable:!1}]}},computed:{filteredUsers:function(){var t=this,e=this.users;return null!==this.statusFilter&&(e=e.filter((function(e){return e.is_staff===t.statusFilter}))),e}},methods:{loadUsers:function(){var t=this;return(0,O.A)((0,F.A)().mark((function e(){var s;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,U().get("/api/users/");case 4:s=e.sent,t.users=s.data,e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error("Ошибка загрузки пользователей:",e.t0),t.$toast.error("Ошибка загрузки пользователей");case 12:return e.prev=12,t.loading=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})))()},toggleStaffStatus:function(t){var e=this;return(0,O.A)((0,F.A)().mark((function s(){var a,r;return(0,F.A)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(a=t.is_staff?"убрать права администратора":"назначить администратором",r="Вы уверены, что хотите ".concat(a,' у пользователя "').concat(t.username,'"?'),!confirm(r)){s.next=14;break}return s.prev=3,s.next=6,U().patch("/api/users/".concat(t.id,"/"),{is_staff:!t.is_staff});case 6:t.is_staff=!t.is_staff,e.$toast.success("Статус пользователя ".concat(t.username," обновлен")),s.next=14;break;case 10:s.prev=10,s.t0=s["catch"](3),console.error("Ошибка обновления статуса:",s.t0),e.$toast.error("Ошибка обновления статуса пользователя");case 14:case"end":return s.stop()}}),s,null,[[3,10]])})))()},formatDate:function(t){return new Date(t).toLocaleDateString("ru-RU")}},mounted:function(){this.loadUsers()}},jt=Rt;var Bt=(0,_.A)(jt,It,Et,!1,null,null,null);const Qt=Bt.exports;a.Ay.use(w.Ay);var Vt=[{path:"/",name:"PostList",component:E},{path:"/post/:id",name:"PostDetail",component:q,props:!0},{path:"/admin/login",name:"AdminLogin",component:et},{path:"/admin",component:ht,meta:{requiresAuth:!0},children:[{path:"",name:"AdminDashboard",component:kt},{path:"posts",name:"AdminPosts",component:Tt},{path:"users",name:"AdminUsers",component:Qt}]}],Mt=new w.Ay({mode:"hash",base:"/static/",routes:Vt});Mt.beforeEach((function(t,e,s){var a="true"===localStorage.getItem("is_admin"),r=localStorage.getItem("admin_user"),o=localStorage.getItem("admin_token"),n=a&&r&&o;if(t.matched.some((function(t){return t.meta.requiresAuth})))if(n)try{var i=JSON.parse(r);i.is_staff?s():(localStorage.clear(),s("/admin/login"))}catch(l){localStorage.clear(),s("/admin/login")}else localStorage.removeItem("admin_user"),localStorage.removeItem("is_admin"),localStorage.removeItem("admin_token"),s("/admin/login");else"/admin/login"===t.path&&n?s("/admin"):s()}));const Nt=Mt;var qt=s(5453);a.Ay.use(qt.A);const Wt=new qt.A({theme:{dark:!0,themes:{dark:{primary:"#7C4DFF",secondary:"#9E8CFF",accent:"#BB86FC",background:"#0d0b14",surface:"#151226",error:"#FF5252",info:"#8A80FF",success:"#64FFDA",warning:"#FFB300"}}},icons:{iconfont:"mdi"}});var zt=s(2064);s(4301);a.Ay.config.productionTip=!1;var Ht=!0,Jt={NODE_ENV:"production",BASE_URL:"/static/"}.VUE_APP_API_BASE_URL,Yt="https://bot-pomoika.onrender.com/",Zt="http://localhost:8000";U().defaults.baseURL=Jt||(Ht?Yt:Zt),U().defaults.xsrfCookieName="csrftoken",U().defaults.xsrfHeaderName="X-CSRFToken",a.Ay.use(zt.Ay,{position:"top-right",timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1}),a.Ay.prototype.$toast=a.Ay.$toast,U().interceptors.response.use((function(t){return t}),(function(t){return t.response&&401===t.response.status&&(localStorage.removeItem("admin_user"),localStorage.removeItem("is_admin"),localStorage.removeItem("admin_token"),window.location.hash.includes("/admin")&&(window.location.href="/#/admin/login")),Promise.reject(t)})),new a.Ay({router:Nt,vuetify:Wt,render:function(t){return t(x)}}).$mount("#app")}},e={};function s(a){var r=e[a];if(void 0!==r)return r.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,s),o.exports}s.m=t,(()=>{var t=[];s.O=(e,a,r,o)=>{if(!a){var n=1/0;for(u=0;u<t.length;u++){for(var[a,r,o]=t[u],i=!0,l=0;l<a.length;l++)(!1&o||n>=o)&&Object.keys(s.O).every((t=>s.O[t](a[l])))?a.splice(l--,1):(i=!1,o<n&&(n=o));if(i){t.splice(u--,1);var c=r();void 0!==c&&(e=c)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[a,r,o]}})(),(()=>{s.n=t=>{var e=t&&t.__esModule?()=>t["default"]:()=>t;return s.d(e,{a:e}),e}})(),(()=>{s.d=(t,e)=>{for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{s.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}})(),(()=>{var t={524:0};s.O.j=e=>0===t[e];var e=(e,a)=>{var r,o,[n,i,l]=a,c=0;if(n.some((e=>0!==t[e]))){for(r in i)s.o(i,r)&&(s.m[r]=i[r]);if(l)var u=l(s)}for(e&&e(a);c<n.length;c++)o=n[c],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(u)},a=self["webpackChunkblog_frontend"]=self["webpackChunkblog_frontend"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))})();var a=s.O(void 0,[504],(()=>s(1831)));a=s.O(a)})();